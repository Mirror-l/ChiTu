var chitu;!function(a){function b(a,b){var c="http://".toLowerCase();if(a.substr(0,c.length).toLowerCase()==c){var d=document.createElement("a");d.setAttribute("href",a),a=decodeURI(d.pathname);var e=f.addRoute(a);return c+d.host+e.interpolate(b)}var e=f.addRoute(a);return e.interpolate(b)}function c(c){var d=c.values().action;if(!d)throw e.routeDataRequireAction();var f=b(c.actionPath(),c.values()),h=$.Deferred();return requirejs([f],function(b){if(!b)return console.warn(a.Utility.format("加载活动“{1}.{0}”失败。",d,c.values().controller)),void h.reject();var e=b.func||b;if(!$.isFunction(e))throw a.Errors.modelFileExpecteFunction(d);var f=new g(self,d,e);h.resolve(f)},function(a){return h.reject(a)}),h}function d(a){if(!a.values().controller)throw e.routeDataRequireController();if(!a.values().action)throw e.routeDataRequireAction();var c=b(a.viewPath(),a.values()),d=$.Deferred(),f="http://";return c.substr(0,f.length).toLowerCase()==f?$.ajax({url:c}).done(function(a){null!=a?d.resolve(a):d.reject()}).fail(function(a){return d.reject(a)}):requirejs(["text!"+c],function(a){null!=a?d.resolve(a):d.reject()},function(a){return d.reject(a)}),d}var e=a.Errors,f=window.crossroads,g=function(){function b(b,c,d){if(!b)throw a.Errors.argumentNull("controller");if(!c)throw a.Errors.argumentNull("name");if(!d)throw a.Errors.argumentNull("handle");if(!$.isFunction(d))throw a.Errors.paramTypeError("handle","Function");this._name=c,this._handle=d}return b.prototype.name=function(){return this._name},b.prototype.execute=function(b,c){if(!b)throw e.argumentNull("page");var d=this._handle.apply({},[b].concat(c));return a.Utility.isDeferred(d)?d:$.Deferred().resolve()},b}();a.Action=g,a.createActionDeferred=c,a.createViewDeferred=d}(chitu||(chitu={}));var chitu;!function(a){var b=a,c=(a.Utility,a.Errors),d=10,e=function(){function e(d){if(this.pageCreating=b.Callbacks(),this.pageCreated=b.Callbacks(),this._routes=new a.RouteCollection,this._runned=!1,this.container_stack=new Array,null==d)throw c.argumentNull("container");this._config=d,this._config.openSwipe=d.openSwipe||function(b){return a.SwipeDirection.None},this._config.closeSwipe=d.closeSwipe||function(b){return a.SwipeDirection.None},this._config.container=d.container||$.proxy(function(b,c){return a.PageContainerFactory.createInstance(this.app,b,c)},{app:this})}return e.prototype.on_pageCreating=function(b){return a.fireCallback(this.pageCreating,[this,b])},e.prototype.on_pageCreated=function(b){return a.fireCallback(this.pageCreated,[this,b])},Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),e.prototype.routes=function(){return this._routes},e.prototype.currentPage=function(){return this.container_stack.length>0?this.container_stack[this.container_stack.length-1].currentPage:null},Object.defineProperty(e.prototype,"pageContainers",{get:function(){return this.container_stack},enumerable:!0,configurable:!0}),e.prototype.createPageContainer=function(b){var c=this.config.container(b,this.pageContainers[this.pageContainers.length-1]);if(this.container_stack.push(c),this.container_stack.length>d){var e=this.container_stack.shift();e.close(a.SwipeDirection.None)}return c},e.prototype.hashchange=function(){if(1==window.location.skip)return void(window.location.skip=!1);var b;this.back_deferred&&null==this.back_deferred.processed&&(b=this.back_deferred,b.processed=!0);var c=window.location.hash;if(!c||c==this.start_flag_hash)return c||console.log("The url is not contains hash.url is "+window.location.href),c==this.start_flag_hash&&(window.history.pushState({},"",this.start_hash),console.log("The hash is start url, the hash is "+c)),void(b&&b.reject());this.start_flag_hash||(this.start_flag_hash="#AABBCCDDEEFF",this.start_hash=c,window.history.replaceState({},"",this.start_flag_hash),window.history.pushState({},"",c));var d=c.substr(1),e=this.routes().getRouteData(d),f=a.Page.getPageName(e),g=this.getPage(f),h=null!=g?g.container:null;if(null!=h&&$.inArray(h,this.container_stack)==this.container_stack.length-2){var i=this.container_stack.pop(),j=this.config.closeSwipe(i.currentPage.routeData);null!=i.previous&&(i.previous.visible=!0),i.close(j)}else{var k=window.location.arguments||{};window.location.arguments=null,this.showPage(c.substr(1),k)}b&&b.resolve()},e.prototype.run=function(){if(!this._runned){$.proxy(this.hashchange,this)(),$(window).bind("hashchange",$.proxy(this.hashchange,this)),this._runned=!0}},e.prototype.getPage=function(a){for(var b=this.container_stack.length-1;b>=0;b--){var c=this.container_stack[b].pages[a];if(null!=c)return c}return null},e.prototype.showPage=function(a,b){var d=this;if(!a)throw c.argumentNull("url");var e=this.routes().getRouteData(a);if(null==e)throw c.noneRouteMatched(a);var f=this.createPageContainer(e);f.pageCreated.add(function(a,b){return d.on_pageCreated(b)});var g=this.config.openSwipe(e),h=f.showPage(e,b,g);return h},e.prototype.createPageNode=function(){var a=document.createElement("div");return a},e.prototype.redirect=function(a,b){return window.location.skip=!0,window.location.hash=a,this.showPage(a,b)},e.prototype.back=function(a){return void 0===a&&(a=void 0),this.back_deferred=$.Deferred(),0==window.history.length?(this.back_deferred.reject(),this.back_deferred):(window.history.back(),this.back_deferred)},e}();a.Application=e}(chitu||(chitu={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},chitu;!function(a){var b;!function(a){a[a.ios=0]="ios",a[a.android=1]="android",a[a.other=2]="other"}(b||(b={}));var c={div:"div",iscroll:"iscroll",doc:"doc"},d=function(){function a(){var a=navigator.userAgent;if(a.indexOf("iPhone")>0||a.indexOf("iPad")>0){this._os=b.ios;var c=a.match(/iPhone OS\s([0-9\-]*)/);if(c){var d=parseInt(c[1],10);this._version=d}}else if(a.indexOf("Android")>0){this._os=b.android;var c=a.match(/Android\s([0-9\.]*)/);if(c){var d=parseInt(c[1],10);this._version=d}}else this._os=b.other}return Object.defineProperty(a.prototype,"osVersion",{get:function(){return this._version},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"os",{get:function(){return this._os},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isIOS",{get:function(){return this.os==b.ios},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isAndroid",{get:function(){return this.os==b.android},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isDegrade",{get:function(){return(this.isWeiXin||this.osVersion<=4)&&this.isAndroid?!0:navigator.userAgent.indexOf("MQQBrowser")>=0?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isWeiXin",{get:function(){var a=navigator.userAgent.toLowerCase();return"micromessenger"==a.match(/MicroMessenger/i)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isIPhone",{get:function(){return window.navigator.userAgent.indexOf("iPhone")>0},enumerable:!0,configurable:!0}),Object.defineProperty(a,"instance",{get:function(){return a._instance||(a._instance=new a),a._instance},enumerable:!0,configurable:!0}),a}(),e=function(){function a(){}return a.createControls=function(b,c){a.transformElement(b);for(var d=new Array,e=b.childNodes,f=0;f<e.length;f++){var g=e[f].nodeType;if(1==g){var h=a.createControl(e[f],c);null!=h&&d.push(h)}}return d},a.createControl=function(a,b){return g.createControl(a,b)},a.transformElement=function(b){var e=b;switch(e.tagName){case"SCROLL-VIEW":var f=$(e).attr("scroll-type");if(null==f&&(f=d.instance.isDegrade?c.doc:d.instance.isIOS?c.iscroll:d.instance.isAndroid&&d.instance.osVersion>=5?c.div:c.doc),f==c.iscroll){var g=document.createElement("scroller");g.innerHTML=e.innerHTML,e.innerHTML="",e.appendChild(g)}$(e).attr("scroll-type",f)}for(var h=0;h<b.childNodes.length;h++)a.transformElement(b.childNodes[h])},a}();a.ControlFactory=e;var f=function(){function b(a){this.parent=a,this.items=[]}return b.prototype.add=function(b){if(null==b)throw a.Errors.argumentNull("control");this[this.length]=this.items[this.items.length]=b,b.parent=this.parent},Object.defineProperty(b.prototype,"length",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),b.prototype.item=function(a){if("number"==typeof a)return this.items[a];for(var b=a,c=0;c<this.items.length;c++)if(this.items[c].name==b)return this.items[c];return null},b}();a.ControlCollection=f;var g=function(){function b(b,c){if(this._children=new f(this),this.load=a.Callbacks(),null==b)throw a.Errors.argumentNull("element");if(null==c)throw a.Errors.argumentNull("page");this._element=b,this._page=c,this._name=$(b).attr("name"),$(b).data("control",this),this.createChildren(b,c)}return b.prototype.createChildren=function(a,b){for(var c=0;c<a.childNodes.length;c++)if(1==a.childNodes[c].nodeType){var d=this.createChild(a.childNodes[c],b);null!=d&&this.children.add(d)}},b.prototype.createChild=function(a,b){var c=e.createControl(a,b);return c},Object.defineProperty(b.prototype,"visible",{get:function(){var a=this.element.style.display;return"none"!=a},set:function(a){1==a?this.element.style.display="block":this.element.style.display="none"},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"page",{get:function(){return this._page},enumerable:!0,configurable:!0}),b.prototype.fireEvent=function(b,c){return a.fireCallback(b,[this,c])},b.prototype.on_load=function(b){var c=new Array;c.push(this.fireEvent(this.load,b));for(var d=0;d<this.children.length;d++){var e=this.children.item(d).on_load(b);a.Utility.isDeferred(e)&&c.push(e)}var f=$.when.apply($,c);return f},b.register=function(a,c){b.ControlTags[a]=c},b.createControl=function(c,d){if(null==c)throw a.Errors.argumentNull("element");if(null==d)throw a.Errors.argumentNull("page");var e=c.tagName,f=b.ControlTags[e];if(null==f)return null;var g;return g=null!=f.prototype?new f(c,d):f(c,d)},b.ControlTags={},b}();a.Control=g;var h=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b}(g);a.PageHeader=h;var i=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b}(g);a.PageFooter=i;var j=function(){function a(){}return a}();a.ScrollArguments=j;var k=function(b){function d(c,e){b.call(this,c,e),this.scroll=a.Callbacks(),this.scrollEnd=a.Callbacks(),this.scrollEnd.add(d.page_scrollEnd);var f=$(c).find("STATUS-BAR");f.length>0&&(this._bottomLoading=new n(f[0],e))}return __extends(d,b),d.prototype.on_load=function(a){var c;return null!=this.scrollLoad&&(c=this.scrollLoad(this,a)),c=null!=c?$.when(c,b.prototype.on_load.call(this,a)):b.prototype.on_load.call(this,a)},d.prototype.on_scrollEnd=function(b){return d.scrolling=!1,a.fireCallback(this.scrollEnd,[this,b])},d.prototype.on_scroll=function(b){return d.scrolling=!0,a.fireCallback(this.scroll,[this,b])},d.createInstance=function(a,b){var d=$(a).attr("scroll-type");return d==c.doc?new l(a,b):d==c.iscroll?new o(a,b):d==c.div?new m(a,b):new l(a,b)},Object.defineProperty(d.prototype,"bottomLoading",{get:function(){return this._bottomLoading},enumerable:!0,configurable:!0}),d.page_scrollEnd=function(a,b){var c=b.scrollTop,d=b.scrollHeight,e=b.clientHeight,f=e/3;if(!(d-f>e+c)&&null!=a.scrollLoad){var g=a.scrollLoad(a,b);g.done(function(){null!=a.bottomLoading&&(a.bottomLoading.visible=0!=b.enableScrollLoad)})}},d.scrolling=!1,d}(g);a.ScrollView=k;var l=function(a){function b(b,c){var d=this;a.call(this,b,c),this.cur_scroll_args=new j,this.CHECK_INTERVAL=300,$(document).scroll(function(a){var b=new j;b.scrollTop=$(document).scrollTop(),b.scrollHeight=document.body.scrollHeight,b.clientHeight=$(window).height(),d.cur_scroll_args.clientHeight=b.clientHeight,d.cur_scroll_args.scrollHeight=b.scrollHeight,d.cur_scroll_args.scrollTop=b.scrollTop,d.scrollEndCheck()})}return __extends(b,a),b.createElement=function(a,b){var c=document.createElement("div");return c.innerHTML=a,b.element.appendChild(c),c},b.prototype.scrollEndCheck=function(){var a=this;null==this.checking_num&&(this.checking_num=0,this.checking_num=window.setInterval(function(){return a.pre_scroll_top==a.cur_scroll_args.scrollTop?(window.clearInterval(a.checking_num),a.checking_num=null,a.pre_scroll_top=null,void a.on_scrollEnd(a.cur_scroll_args)):void(a.pre_scroll_top=a.cur_scroll_args.scrollTop)},this.CHECK_INTERVAL))},b}(k),m=function(a){function b(b,c){var d=this;a.call(this,b,c),this.cur_scroll_args=new j,this.CHECK_INTERVAL=30,this.element.onscroll=function(){d.cur_scroll_args.scrollTop=d.element.scrollTop,d.cur_scroll_args.clientHeight=d.element.clientHeight,d.cur_scroll_args.scrollHeight=d.element.scrollHeight,d.on_scroll(d.cur_scroll_args),d.scrollEndCheck()}}return __extends(b,a),b.prototype.scrollEndCheck=function(){var a=this;null==this.checking_num&&(this.checking_num=0,this.checking_num=window.setInterval(function(){return a.pre_scroll_top==a.cur_scroll_args.scrollTop?(window.clearInterval(a.checking_num),a.checking_num=null,a.pre_scroll_top=null,void a.on_scrollEnd(a.cur_scroll_args)):void(a.pre_scroll_top=a.cur_scroll_args.scrollTop)},this.CHECK_INTERVAL))},b}(k),n=function(a){function b(b,c){a.call(this,b,c),b.innerHTML='<div name="scrollLoad_loading" style="padding:10px 0px 10px 0px;">         <h5 class="text-center">                 <i class="icon-spinner icon-spin"></i><span style="padding-left:10px;">数据正在加载中...</span>             </h5>     </div>'}return __extends(b,a),b}(g);a.ScrollViewStatusBar=n;var o=function(a){function b(b,c){var d=this;a.call(this,b,c),requirejs(["iscroll"],function(){return d.init(d.element)})}return __extends(b,a),b.prototype.init=function(a){var b={tap:!0,useTransition:!1,HWCompositing:!1,preventDefault:!0,probeType:1},c=this.iscroller=new IScroll(a,b);c.page_container=this,c.on("scrollEnd",function(){var a=this,b={scrollTop:0-a.y,scrollHeight:a.scrollerHeight,clientHeight:a.wrapperHeight};d.on_scrollEnd(b)});var d=this;c.on("scroll",function(){var a=this,b={scrollTop:0-a.y,scrollHeight:a.scrollerHeight,clientHeight:a.wrapperHeight};d.on_scroll(b)}),function(a,b){$(b).on("tap",function(b){if(0!=a.enabled)for(var c=4,d=1,e=b.target;null!=e;){if("A"==e.tagName)return window.open($(e).attr("href"),"_self");if(e=e.parentNode,d+=1,d>c)return}})}(c,a),$(window).on("resize",function(){window.setTimeout(function(){return c.refresh()},500)})},b.prototype.refresh=function(){null!=this.iscroller&&this.iscroller.refresh()},b}(k);a.IScrollView=o;var p=function(b){function c(a,c){b.call(this,a,c),this._loaded_count=0,this.loading_element=document.createElement("page-loading"),this.loading_element.className="page-loading",this.loading_element.innerHTML=this.defaultHtml(),a.appendChild(this.loading_element)}return __extends(c,b),c.prototype.defaultHtml=function(){var a='<div class="spin"><i class="icon-spinner icon-spin"></i><div>';return a},Object.defineProperty(c.prototype,"loaded_count",{set:function(a){if(this._loaded_count=this._loaded_count+1,this._loaded_count>=this.children.length){this.loading_element.style.display="none";for(var b=0;b<this.children.length;b++)this.children[b].visible=!0}},enumerable:!0,configurable:!0}),c.prototype.createChild=function(d,e){var f=this,g=b.prototype.createChild.call(this,d,e);return null!=g?(g.visible=!1,g.on_load=function(b){var d=c._on_load.apply(this,[b]);return a.Utility.isDeferred(d)?d.done(function(){return f.loaded_count=f.loaded_count+1}):f.loaded_count=f.loaded_count+1,d},g):void 0},c._on_load=g.prototype.on_load,c}(g);a.FormLoading=p,g.register("FORM-LOADING",p),g.register("HEADER",h),g.register("TOP-BAR",h),g.register("SCROLL-VIEW",k.createInstance),g.register("FOOTER",i),g.register("BOTTOM-BAR",i)}(chitu||(chitu={}));var chitu;!function(a){var b=function(){function b(){}return b.argumentNull=function(b){var c=a.Utility.format('The argument "{0}" cannt be null.',b);return new Error(c)},b.modelFileExpecteFunction=function(b){var c=a.Utility.format('The eval result of script file "{0}" is expected a function.',b);return new Error(c)},b.paramTypeError=function(b,c){var d=a.Utility.format('The param "{0}" is expected "{1}" type.',b,c);return new Error(d)},b.paramError=function(a){return new Error(a)},b.viewNodeNotExists=function(b){var c=a.Utility.format('The view node "{0}" is not exists.',b);return new Error(c)},b.pathPairRequireView=function(b){var c=a.Utility.format('The view value is required for path pair, but the item with index "{0}" is miss it.',b);return new Error(c)},b.notImplemented=function(b){var c=a.Utility.format('The method "{0}" is not implemented.',b);return new Error(c)},b.routeExists=function(b){var c=a.Utility.format('Route named "{0}" is exists.',b);return new Error(c)},b.routeResultRequireController=function(b){var c=a.Utility.format('The parse result of route "{0}" does not contains controler.',b);return new Error(c)},b.routeResultRequireAction=function(b){var c=a.Utility.format('The parse result of route "{0}" does not contains action.',b);return new Error(c)},b.ambiguityRouteMatched=function(b,c,d){var e=a.Utility.format("Ambiguity route matched, {0} is match in {1} and {2}.",b,c,d);return new Error(e)},b.noneRouteMatched=function(b){var c=a.Utility.format('None route matched with url "{0}".',b),d=new Error(c);return d},b.emptyStack=function(){return new Error("The stack is empty.")},b.canntParseUrl=function(b){var c=a.Utility.format('Can not parse the url "{0}" to route data.',b);return new Error(c)},b.routeDataRequireController=function(){var a='The route data does not contains a "controller" file.';return new Error(a)},b.routeDataRequireAction=function(){var a='The route data does not contains a "action" file.';return new Error(a)},b.parameterRequireField=function(b,c){var d=a.Utility.format("Parameter {1} does not contains field {0}.",b,c);return new Error(d)},b.viewCanntNull=function(){var a="The view or viewDeferred of the page cannt null.";return new Error(a)},b}();a.Errors=b}(chitu||(chitu={}));var chitu;!function(a){function b(a){var b=f[a]={};return jQuery.each(a.match(e)||[],function(a,c){b[c]=!0}),b}function c(c){void 0===c&&(c=null),c="string"==typeof c?f[c]||b(c):jQuery.extend({},c);var d,e,g,h,i,j,k=[],l=!c.once&&[],m=function(a){for(d=c.memory&&a,e=!0,j=h||0,h=0,i=k.length,g=!0;k&&i>j;j++){var b=k[j].apply(a[0],a[1]);if(null!=b&&a[0].results.push(b),b===!1&&c.stopOnFalse){d=!1;break}}g=!1,k&&(l?l.length&&m(l.shift()):d?k=[]:n.disable())},n={results:[],add:function(){if(k){var a=k.length;!function b(a){jQuery.each(a,function(a,d){var e=jQuery.type(d);"function"===e?c.unique&&n.has(d)||k.push(d):d&&d.length&&"string"!==e&&b(d)})}(arguments),g?i=k.length:d&&(h=a,m(d))}return this},remove:function(){return k&&jQuery.each(arguments,function(a,b){for(var c;(c=jQuery.inArray(b,k,c))>-1;)k.splice(c,1),g&&(i>=c&&i--,j>=c&&j--)}),this},has:function(a){return a?jQuery.inArray(a,k)>-1:!(!k||!k.length)},empty:function(){return k=[],i=0,this},disable:function(){return k=l=d=void 0,this},disabled:function(){return!k},lock:function(){return l=void 0,d||n.disable(),this},locked:function(){return!l},fireWith:function(a,b){return a.results=[],!k||e&&!l||(b=b||[],b=[a,b.slice?b.slice():b],g?l.push(b):m(b)),a.results},fire:function(){return n.fireWith(this,arguments)},fired:function(){return!!e},count:function(){return k.length}};return new a.Callback(n)}function d(b,c){for(var d=b.fire.apply(b,c),e=[],f=0;f<d.length;f++)a.Utility.isDeferred(d[f])&&e.push(d[f]);return 0==e.length?$.Deferred().resolve():$.when.apply($,e)}var e=/\S+/g,f={},g=function(){function a(a){this.source=a}return a.prototype.add=function(a){this.source.add(a)},a.prototype.remove=function(a){this.source.remove(a)},a.prototype.has=function(a){return this.source.has(a)},a.prototype.fireWith=function(a,b){return this.source.fire(a,b)},a.prototype.fire=function(a,b,c,d){return this.source.fire(a,b,c)},a}();a.Callback=g,a.Callbacks=c,a.fireCallback=d;var h=window.crossroads;$.extend(h,{_create:h.create,create:function(){var b=this._create();return b.getRouteData=function(b,c){if(b=b||"",c=c||[],this.ignoreState||b!==this._prevMatchedRequest&&b!==this._prevBypassedRequest){var d=this._getMatchedRoutes(b),e=d.length;if(0==e)return null;if(e>1)throw a.Errors.ambiguityRouteMatched(b,"route1","route2");return d[0]}},b}})}(chitu||(chitu={}));var chitu;!function(a){var b=a,c=(a.Utility,a.Errors);!function(a){a[a.init=0]="init",a[a.scroll=1]="scroll",a[a.pullDown=2]="pullDown",a[a.pullUp=3]="pullUp",a[a.custom=4]="custom"}(a.PageLoadType||(a.PageLoadType={}));var d;a.PageLoadType;!function(a){a[a.swipeLeft=0]="swipeLeft",a[a.swipeRight=1]="swipeRight",a[a.none=2]="none"}(d||(d={}));var e;!function(a){a[a.header=1]="header",a[a.body=2]="body",a[a.loading=4]="loading",a[a.footer=8]="footer"}(e||(e={}));var f;!function(a){a[a.open=0]="open",a[a.closed=1]="closed"}(f||(f={})),function(a){a[a.None=0]="None",a[a.Left=1]="Left",a[a.Right=2]="Right",a[a.Up=3]="Up",a[a.Down=4]="Down"}(a.SwipeDirection||(a.SwipeDirection={}));var g=a.SwipeDirection;!function(a){a[a.IScroll=0]="IScroll",a[a.Div=1]="Div",a[a.Document=2]="Document"}(a.ScrollType||(a.ScrollType={}));var h=(a.ScrollType,function(){function d(a,e,f,g,h,i){var j=this;if(this._loadViewModelResult=null,this._openResult=null,this._hideResult=null,this._showTime=d.animationTime,this._hideTime=d.animationTime,this._enableScrollLoad=!1,this.is_closed=!1,this.isActionExecuted=!1,this.preLoad=b.Callbacks(),this.load=b.Callbacks(),this.loadCompleted=b.Callbacks(),this.closing=b.Callbacks(),this.closed=b.Callbacks(),this.showing=b.Callbacks(),this.shown=b.Callbacks(),this.hiding=b.Callbacks(),this.hidden=b.Callbacks(),this.viewChanged=b.Callbacks(),!a)throw c.argumentNull("container");if(null==e)throw c.argumentNull("scrorouteDatallType");if(null==g)throw c.argumentNull("action");if(null==h)throw c.argumentNull("view");this._pageContainer=a,this._node=document.createElement("page"),$(this._node).data("page",this),this._actionDeferred=g,this._viewDeferred=h,this._prevous=i,this._routeData=e,this.action.done(function(a){a.execute(j,f),j.view&&j.view.done(function(a){j.element.innerHTML=a,j._controls=j.createControls(j.element),j.viewHtml=a,j.on_load(e.values())})})}return d.prototype.createControls=function(b){this._controls=a.ControlFactory.createControls(b,this);for(var c=new Array,d=0;d<this._controls.length;d++)c.push(this._controls[d]);return this._controls},Object.defineProperty(d.prototype,"view",{get:function(){return this._viewDeferred},set:function(a){this._viewDeferred=a},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"action",{get:function(){return this._actionDeferred},set:function(a){this._actionDeferred=a},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"enableScrollLoad",{get:function(){return this._enableScrollLoad},set:function(a){this._enableScrollLoad=a},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"viewHtml",{get:function(){return this._viewHtml},set:function(a){this._viewHtml=a,this.on_viewChanged({})},enumerable:!0,configurable:!0}),d.getPageName=function(a){var b;if(a.pageName()){var c=window.crossroads.addRoute(a.pageName());b=c.interpolate(a.values())}else b=a.values().controller+"."+a.values().action;return b},Object.defineProperty(d.prototype,"routeData",{get:function(){return this._routeData},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"name",{get:function(){return this._name||(this._name=d.getPageName(this.routeData)),this._name},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"element",{get:function(){return this._node},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"previous",{get:function(){return this._prevous},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"visible",{get:function(){return $(this._node).is(":visible")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"container",{get:function(){return this._pageContainer},enumerable:!0,configurable:!0}),d.prototype.hide=function(a){return a=a||g.None,this.container.hide(a)},d.prototype.findControl=function(b){if(!b)throw a.Errors.argumentNull("name");for(var c=new Array,d=0;d<this._controls.length;d++){var e=this._controls[d];c.push(e)}for(;c.length>0;){var e=c.pop();if(e.name==b)return e;for(var d=0;d<e.children.length;d++)c.push(e.children[d])}return null},d.prototype.fireEvent=function(b,c){return a.fireCallback(b,[this,c])},d.prototype.on_load=function(a){var b=this,c=new Array;c.push(this.fireEvent(this.load,a));for(var d=0;d<this._controls.length;d++){var e=this._controls[d].on_load(a);c.push(e)}var f=$.when.apply($,c);return null==this.view?f.done(function(){return b.on_loadCompleted(a)}):"resolved"==this.view.state()?f.done(function(){return b.on_loadCompleted(a)}):$.when(this.view,f).done(function(){return b.on_loadCompleted(a)}),f},d.prototype.on_loadCompleted=function(a){this.fireEvent(this.loadCompleted,a)},d.prototype.on_closing=function(a){return this.fireEvent(this.closing,a)},d.prototype.on_closed=function(a){return this.fireEvent(this.closed,a)},d.prototype.on_showing=function(a){return this.fireEvent(this.showing,a)},d.prototype.on_shown=function(a){return this.fireEvent(this.shown,a)},d.prototype.on_hiding=function(a){return this.fireEvent(this.hiding,a)},d.prototype.on_hidden=function(a){return this.fireEvent(this.hidden,a)},d.prototype.on_viewChanged=function(a){return this.fireEvent(this.viewChanged,a)},d.animationTime=300,d}());a.Page=h}(chitu||(chitu={}));var chitu;!function(a){var b=(function(){function a(){}return a}(),function(){function a(){this.Div="div",this.IScroll="iscroll",this.Document="doc"}return a}(),function(){function b(b,c){this.animationTime=300,this._previousOffsetRate=.5,this.enableSwipeClose=!0,this.pageCreated=a.Callbacks(),this.is_closing=!1,this._node=this.createNode(),this._loading=this.createLoading(this._node),this._pages=new Array,this._previous=c,this._app=b,this.gesture=new e,this._enableSwipeBack()}return b.prototype.on_pageCreated=function(b){return a.fireCallback(this.pageCreated,[this,b])},b.prototype._enableSwipeBack=function(){var b=this,c=this;if(null!=c.previous&&0!=this.enableSwipeClose){var d,e,f=c.element,g=$(window).width()/2,h=35,i=c.gesture.createPan(c.element);i.start=function(g){f.style.webkitTransform="",f.style.transform="";var i=new WebKitCSSMatrix(c.previous.element.style.webkitTransform);if(d=i.m41,1==a.ScrollView.scrolling)return!1;var j=Math.atan(Math.abs(g.deltaY/g.deltaX))/3.14159265*180;if(j>h)return!1;var k=null!=c.previous&&0!=(g.direction&Hammer.DIRECTION_RIGHT)&&(b.open_swipe==a.SwipeDirection.Left||b.open_swipe==a.SwipeDirection.Right);return 1==k&&(e=b.previous.visible,b.previous.visible=!0),k},i.left=function(a){return a.deltaX<=0?(move(f).x(0).duration(0).end(),void move(b.previous.element).x(d).duration(0).end()):(move(f).x(a.deltaX).duration(0).end(),void move(b.previous.element).x(d+a.deltaX*b._previousOffsetRate).duration(0).end())},i.right=function(a){move(f).x(a.deltaX).duration(0).end(),move(b.previous.element).x(d+a.deltaX*b._previousOffsetRate).duration(0).end()},i.end=function(h){return h.deltaX>g?void b._app.back():(move(f).x(0).duration(a.Page.animationTime).end(),void move(c.previous.element).x(d).duration(a.Page.animationTime).end(function(){return b.previous.visible=e}))}}},b.prototype.createNode=function(){return this._node=document.createElement("div"),this._node.className="page-container",this._node.style.display="none",document.body.appendChild(this._node),this._node},b.prototype.createLoading=function(a){var b=document.createElement("div");return b.className="page-loading",b.innerHTML='<div class="spin"><i class="icon-spinner icon-spin"></i><div>',a.appendChild(b),b},b.prototype.show=function(b){var c=this;if(1==this.visible)return $.Deferred().resolve();var d=$(this._node).width(),e=$(this._node).height(),f=$.Deferred(),g=function(){null!=c.previous&&(c.previous.visible=!1),f.resolve()};switch(this.open_swipe=b,b){case a.SwipeDirection.None:default:$(this._node).show(),g();break;case a.SwipeDirection.Down:move(this.element).y(0-e).duration(0).end(),$(this._node).show(),window.setTimeout(function(){move(c.element).y(0).duration(c.animationTime).end(g)},30);break;case a.SwipeDirection.Up:move(this.element).y(e).duration(0).end(),$(this._node).show(),window.setTimeout(function(){move(c.element).y(0).duration(c.animationTime).end(g)},30);break;case a.SwipeDirection.Right:move(this.element).x(0-d).duration(0).end(),$(this._node).show(),window.setTimeout(function(){null!=c.previous&&move(c.previous.element).x(d*c._previousOffsetRate).duration(c.animationTime).end(),move(c.element).x(0).duration(c.animationTime).end(g)},30);break;case a.SwipeDirection.Left:move(this.element).x(d).duration(0).end(),$(this._node).show(),window.setTimeout(function(){null!=c.previous&&move(c.previous.element).x(0-d*c._previousOffsetRate).duration(c.animationTime).end(),move(c.element).x(0).duration(c.animationTime).end(g)},30)}return f},b.prototype.hide=function(b){if(0==this.visible)return $.Deferred().resolve();var c=$(this._node).width(),d=$(this._node).height(),e=$.Deferred();switch(b){case a.SwipeDirection.None:default:null!=this.previous&&move(this.previous.element).x(0).duration(this.animationTime).end(),e.resolve();break;case a.SwipeDirection.Down:move(this.element).y(d).duration(this.animationTime).end(function(){return e.resolve()});break;case a.SwipeDirection.Up:move(this.element).y(0-d).duration(this.animationTime).end(function(){return e.resolve()});break;case a.SwipeDirection.Right:null!=this.previous&&move(this.previous.element).x(0).duration(this.animationTime).end(),move(this.element).x(c).duration(this.animationTime).end(function(){return e.resolve()});break;case a.SwipeDirection.Left:null!=this.previous&&move(this.previous.element).x(0).duration(this.animationTime).end(),move(this.element).x(0-c).duration(this.animationTime).end(function(){return e.resolve()})}return e},b.prototype.close=function(a){var b=this;this.is_closing||(this.is_closing=!0,this.hide(a).done(function(){$(b._node).remove()}))},b.prototype.showLoading=function(){this._loading.style.display="block"},b.prototype.hideLoading=function(){this._loading.style.display="none"},Object.defineProperty(b.prototype,"visible",{get:function(){return $(this._node).is(":visible")},set:function(a){a?$(this._node).show():$(this._node).hide()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"element",{get:function(){return this._node},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"currentPage",{get:function(){return this._currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"pages",{get:function(){return this._pages},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"previous",{get:function(){return this._previous},enumerable:!0,configurable:!0}),b.prototype.createPage=function(b,c){var d,e=(b.values().controller,b.values().action,a.createViewDeferred(b)),f=a.createActionDeferred(b);new a.PageContext(e,b);this._pages.length>0&&(d=this._pages[this._pages.length-1]);var g=new a.Page(this,b,c,f,e,d);return this.on_pageCreated(g),this._pages.push(g),this._pages[g.name]=g,g},b.prototype.showPage=function(a,b,c){var d=this,e=this.createPage(a,b);return this.element.appendChild(e.element),this._currentPage=e,e.on_showing(a.values()),this.show(c).done(function(){e.on_shown(a.values())}),e.loadCompleted.add(function(){return d.hideLoading()}),e},b}());a.PageContainer=b;var c=function(){function a(a){this._app=a}return a.createInstance=function(a,c,d){
return new b(a,d)},a}();a.PageContainerFactory=c;var d=function(){function a(a){this.cancel=!1}return a}();a.Pan=d;var e=function(){function b(){var a=this;this._prevent={pan:Hammer.DIRECTION_NONE},this.prevent={pan:function(b){a._prevent.pan=b}},this.executedCount=0,this.hammersCount=0}return b.prototype.getHammer=function(a){var b=this,c=$(a).data("hammer");return null==c&&(c=new Hammer.Manager(a),c.add(new Hammer.Pan({direction:Hammer.DIRECTION_HORIZONTAL})),$(a).data("hammer",c),this.hammersCount=this.hammersCount+1,c.on("pan",function(a){for(var d=b.getPans(c.element),e=d.length-1;e>=0;e--){var f=c.get("pan").state;null==d[e].started&&(f&Hammer.STATE_BEGAN)==Hammer.STATE_BEGAN&&(d[e].started=d[e].start(a));var g=!1,h=d[e].started;if(1==h&&((a.direction&Hammer.DIRECTION_LEFT)==Hammer.DIRECTION_LEFT&&null!=d[e].left?d[e].left(a):(a.direction&Hammer.DIRECTION_RIGHT)==Hammer.DIRECTION_RIGHT&&null!=d[e].right?d[e].right(a):(a.direction&Hammer.DIRECTION_UP)==Hammer.DIRECTION_UP&&null!=d[e].up?d[e].up(a):(a.direction&Hammer.DIRECTION_DOWN)==Hammer.DIRECTION_DOWN&&null!=d[e].down&&d[e].down(a),(f&Hammer.STATE_ENDED)==Hammer.STATE_ENDED&&null!=d[e].end&&d[e].end(a),g=!0),(f&Hammer.STATE_ENDED)==Hammer.STATE_ENDED&&(d[e].started=null),1==g)break}})),c},b.prototype.getPans=function(a){var b=$(a).data("pans");return null==b&&(b=new Array,$(a).data("pans",b)),b},b.prototype.clear=function(){this._prevent.pan=Hammer.DIRECTION_NONE},b.prototype.createPan=function(b){if(null==b)throw a.Errors.argumentNull("element");var c=(this.getHammer(b),new d(this)),e=this.getPans(b);return e.push(c),c},b}();a.Gesture=e}(chitu||(chitu={}));var chitu;!function(a){var b=function(){function a(a,b){this._view=a,this._routeData=b}return a.prototype.view=function(){return this._view},a.prototype.routeData=function(){return this._routeData},a}();a.PageContext=b}(chitu||(chitu={}));var chitu;!function(a){var b=function(){function a(a,b,c){this._name=a,this._pattern=b,this._defaults=c}return a.prototype.name=function(){return this._name},a.prototype.defaults=function(){return this._defaults},a.prototype.url=function(){return this._pattern},a}();a.Route=b}(chitu||(chitu={}));var chitu;!function(a){var b=a.Errors,c=function(){function c(){this._init()}return c.prototype._init=function(){var a=window.crossroads;this._source=a.create(),this._source.ignoreCase=!0,this._source.normalizeFn=a.NORM_AS_OBJECT,this._priority=0},c.prototype.count=function(){return this._source.getNumRoutes()},c.prototype.mapRoute=function(c){c=c||{};var d=c.name,e=c.url,f=c.defaults,g=c.rules||{};if(!d)throw b.argumentNull("name");if(!e)throw b.argumentNull("url");this._priority=this._priority+1;var h=new a.Route(d,e,f);h.viewPath=c.viewPath,h.actionPath=c.actionPath;var i=this._source.addRoute(e,function(a){},this._priority);if(i.rules=g,i.newRoute=h,null==this._defaultRoute){if(this._defaultRoute=h,null==this._defaultRoute.viewPath)throw new Error("default route require view path.");if(null==this._defaultRoute.actionPath)throw new Error("default route require action path.")}return h.viewPath=h.viewPath||this._defaultRoute.viewPath,h.actionPath=h.actionPath||this._defaultRoute.actionPath,h},c.prototype.getRouteData=function(c){var d=this._source.getRouteData(c);if(null==d)throw b.canntParseUrl(c);for(var e={},f=d.route._paramsIds||[],g=0;g<f.length;g++){var h=f[g];e[h]=d.params[0][h]}var i=new a.RouteData(c);return i.values(e),i.actionPath(d.route.newRoute.actionPath),i.viewPath(d.route.newRoute.viewPath),i},c.defaultRouteName="default",c}();a.RouteCollection=c}(chitu||(chitu={}));var chitu;!function(a){var b=function(){function a(a){this._url=a}return a.prototype.values=function(a){return void 0===a&&(a=void 0),void 0!==a&&(this._values=a),this._values},a.prototype.viewPath=function(a){return void 0===a&&(a=void 0),void 0!==a&&(this._viewPath=a),this._viewPath},a.prototype.actionPath=function(a){return void 0===a&&(a=void 0),void 0!==a&&(this._actionPath=a),this._actionPath},a.prototype.pageName=function(a){return void 0===a&&(a=void 0),void 0!==a&&(this._pageName=a),this._pageName},a.prototype.url=function(){return this._url},a}();a.RouteData=b}(chitu||(chitu={}));var chitu;!function(a){var b=a.Errors,c=function(){function a(){}return a.isType=function(a,b){for(var c in a.prototype)if(void 0===b[c])return!1;return!0},a.isDeferred=function(a){return null==a?!1:null!=a.pipe&&null!=a.always&&null!=a.done?!0:!1},a.format=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=0;d<b.length;d++)a=a.replace(new RegExp("\\{"+d+"\\}","g"),function(){return b[d]});return a},a.fileName=function(a,c){if(!a)throw b.argumentNull("url");c=c||!0,a=a.replace("http://","/");var d=a.replace(/^.*[\\\/]/,"");if(c===!0){var e=d.split(".");d=e[0]}return d},a.log=function(a,b){if(void 0===b&&(b=[]),window.console){if(null==b)return void console.log(a);var c=this.format.apply(this,arguments);console.log(c)}},a.loadjs=function(a){var b=$.Deferred();return requirejs(a,function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];b.resolve.apply(b,a)}),b},a}();a.Utility=c}(chitu||(chitu={})),"function"==typeof define&&define(function(a,b){return chitu});